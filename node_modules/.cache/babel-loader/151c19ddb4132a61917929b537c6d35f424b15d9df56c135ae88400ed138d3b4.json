{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\ACER\\\\Desktop\\\\Patiend_portal_fronend\\\\Patient_portal_frontend\\\\src\\\\pages\\\\ResetPassword.jsx\",\n  _s = $RefreshSig$();\nimport React, { useMemo, useState } from 'react';\nimport { resetPasswordApi } from '../services/auth';\nimport '../assets/styles/auth.css';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport default function ResetPassword() {\n  _s();\n  const [pw, setPw] = useState('');\n  const [cpw, setCpw] = useState('');\n  const [msg, setMsg] = useState(null);\n  const [err, setErr] = useState(null);\n  const [loading, setLoading] = useState(false);\n\n  // Lấy token từ query ?token=...\n  const token = useMemo(() => {\n    const p = new URLSearchParams(window.location.search);\n    return p.get('token') || '';\n  }, []);\n  const onSubmit = async e => {\n    e.preventDefault();\n    setErr(null);\n    setMsg(null);\n    if (!token) {\n      setErr('Thiếu token khôi phục. Hãy mở link từ email.');\n      return;\n    }\n    if (!pw || !cpw) {\n      setErr('Vui lòng nhập đầy đủ mật khẩu.');\n      return;\n    }\n    if (pw.length < 8) {\n      setErr('Mật khẩu tối thiểu 8 ký tự.');\n      return;\n    }\n    if (pw !== cpw) {\n      setErr('Mật khẩu nhập lại không khớp.');\n      return;\n    }\n    try {\n      setLoading(true);\n      await resetPasswordApi(token, pw);\n      setMsg('Đặt lại mật khẩu thành công! Bạn có thể đăng nhập bằng mật khẩu mới.');\n      // Tự động về trang đăng nhập sau 2 giây\n      setTimeout(() => {\n        window.location.href = '/login';\n      }, 2000);\n    } catch (e2) {\n      setErr((e2 === null || e2 === void 0 ? void 0 : e2.message) || 'Không thể đặt lại mật khẩu. Token có thể đã hết hạn hoặc đã dùng.');\n    } finally {\n      setLoading(false);\n    }\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"auth-container\",\n    children: /*#__PURE__*/_jsxDEV(\"form\", {\n      className: \"auth-card\",\n      onSubmit: onSubmit,\n      children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n        children: \"\\u0110\\u1EB7t l\\u1EA1i m\\u1EADt kh\\u1EA9u\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 43,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n        className: \"muted\",\n        children: \"Nh\\u1EADp m\\u1EADt kh\\u1EA9u m\\u1EDBi cho t\\xE0i kho\\u1EA3n c\\u1EE7a b\\u1EA1n.\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 44,\n        columnNumber: 9\n      }, this), err && /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"alert\",\n        children: err\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 46,\n        columnNumber: 17\n      }, this), msg && /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"alert\",\n        style: {\n          color: '#b7ffc3',\n          borderColor: '#3a6a4b',\n          background: '#1c2a23'\n        },\n        children: msg\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 48,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n        children: \"M\\u1EADt kh\\u1EA9u m\\u1EDBi\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 53,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n        className: \"input\",\n        type: \"password\",\n        value: pw,\n        onChange: e => setPw(e.target.value),\n        placeholder: \"\\u2022\\u2022\\u2022\\u2022\\u2022\\u2022\\u2022\\u2022\",\n        autoComplete: \"new-password\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 54,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n        children: \"Nh\\u1EADp l\\u1EA1i m\\u1EADt kh\\u1EA9u\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 63,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n        className: \"input\",\n        type: \"password\",\n        value: cpw,\n        onChange: e => setCpw(e.target.value),\n        placeholder: \"\\u2022\\u2022\\u2022\\u2022\\u2022\\u2022\\u2022\\u2022\",\n        autoComplete: \"new-password\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 64,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        className: \"btn\",\n        type: \"submit\",\n        disabled: loading,\n        children: loading ? 'Đang cập nhật...' : 'Đặt lại mật khẩu'\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 73,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 42,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 41,\n    columnNumber: 5\n  }, this);\n}\n_s(ResetPassword, \"5exKUZINW2BVEvBxjVkj6TiOJg8=\");\n_c = ResetPassword;\nvar _c;\n$RefreshReg$(_c, \"ResetPassword\");","map":{"version":3,"names":["React","useMemo","useState","resetPasswordApi","jsxDEV","_jsxDEV","ResetPassword","_s","pw","setPw","cpw","setCpw","msg","setMsg","err","setErr","loading","setLoading","token","p","URLSearchParams","window","location","search","get","onSubmit","e","preventDefault","length","setTimeout","href","e2","message","className","children","fileName","_jsxFileName","lineNumber","columnNumber","style","color","borderColor","background","type","value","onChange","target","placeholder","autoComplete","disabled","_c","$RefreshReg$"],"sources":["C:/Users/ACER/Desktop/Patiend_portal_fronend/Patient_portal_frontend/src/pages/ResetPassword.jsx"],"sourcesContent":["import React, { useMemo, useState } from 'react';\r\nimport { resetPasswordApi } from '../services/auth';\r\nimport '../assets/styles/auth.css';\r\n\r\nexport default function ResetPassword() {\r\n  const [pw, setPw] = useState('');\r\n  const [cpw, setCpw] = useState('');\r\n  const [msg, setMsg] = useState(null);\r\n  const [err, setErr] = useState(null);\r\n  const [loading, setLoading] = useState(false);\r\n\r\n  // Lấy token từ query ?token=...\r\n  const token = useMemo(() => {\r\n    const p = new URLSearchParams(window.location.search);\r\n    return p.get('token') || '';\r\n  }, []);\r\n\r\n  const onSubmit = async (e) => {\r\n    e.preventDefault();\r\n    setErr(null); setMsg(null);\r\n\r\n    if (!token) { setErr('Thiếu token khôi phục. Hãy mở link từ email.'); return; }\r\n    if (!pw || !cpw) { setErr('Vui lòng nhập đầy đủ mật khẩu.'); return; }\r\n    if (pw.length < 8) { setErr('Mật khẩu tối thiểu 8 ký tự.'); return; }\r\n    if (pw !== cpw) { setErr('Mật khẩu nhập lại không khớp.'); return; }\r\n\r\n    try {\r\n      setLoading(true);\r\n      await resetPasswordApi(token, pw);\r\n      setMsg('Đặt lại mật khẩu thành công! Bạn có thể đăng nhập bằng mật khẩu mới.');\r\n      // Tự động về trang đăng nhập sau 2 giây\r\n      setTimeout(() => { window.location.href = '/login'; }, 2000);\r\n    } catch (e2) {\r\n      setErr(e2?.message || 'Không thể đặt lại mật khẩu. Token có thể đã hết hạn hoặc đã dùng.');\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className=\"auth-container\">\r\n      <form className=\"auth-card\" onSubmit={onSubmit}>\r\n        <h2>Đặt lại mật khẩu</h2>\r\n        <p className=\"muted\">Nhập mật khẩu mới cho tài khoản của bạn.</p>\r\n\r\n        {err && <div className=\"alert\">{err}</div>}\r\n        {msg && (\r\n          <div className=\"alert\" style={{ color: '#b7ffc3', borderColor: '#3a6a4b', background: '#1c2a23' }}>\r\n            {msg}\r\n          </div>\r\n        )}\r\n\r\n        <label>Mật khẩu mới</label>\r\n        <input\r\n          className=\"input\"\r\n          type=\"password\"\r\n          value={pw}\r\n          onChange={(e) => setPw(e.target.value)}\r\n          placeholder=\"••••••••\"\r\n          autoComplete=\"new-password\"\r\n        />\r\n\r\n        <label>Nhập lại mật khẩu</label>\r\n        <input\r\n          className=\"input\"\r\n          type=\"password\"\r\n          value={cpw}\r\n          onChange={(e) => setCpw(e.target.value)}\r\n          placeholder=\"••••••••\"\r\n          autoComplete=\"new-password\"\r\n        />\r\n\r\n        <button className=\"btn\" type=\"submit\" disabled={loading}>\r\n          {loading ? 'Đang cập nhật...' : 'Đặt lại mật khẩu'}\r\n        </button>\r\n      </form>\r\n    </div>\r\n  );\r\n}\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}